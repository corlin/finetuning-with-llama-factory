# 基于GB/T 39786-2021及相关标准的密码应用QA对（增强版）

## 密码应用安全性评估流程类

### Q31: 密码应用安全性评估的完整流程包括哪些阶段？



<thinking>

这个问题涉及密码应用安全性评估的整体流程，需要从以下几个角度来分析：



1. 流程阶段划分：
   - 测评准备活动：项目启动和准备阶段

   - 方案编制活动：规划确认和方案阶段

   - 现场测评活动：实际执行和验证阶段

   - 分析与报告编制活动：结果分析和总结阶段



2. 各阶段的核心任务：
   - 测评准备：项目启动、信息收集、工具准备

   - 方案编制：确定范围、设计方法、制定方案

   - 现场测评：准备、实施、总结

   - 分析报告：结果分析、风险评估、结论形成



3. 流程的系统性：

   - 每个阶段都有明确的输入输出

   - 阶段间存在逻辑依赖关系

   - 确保评估的全面性和准确性



4. 符合标准要求：

   - 遵循GB/T 43206-2023测评要求

   - 体现密码应用评估的专业性

   - 保证评估结果的可信度

</thinking>



A31: 密码应用安全性评估的完整流程包括方案编制活动、现场测评活动、分析与报告编制活动四个主要阶段。其中测评准备活动是开展测评工作的前提和基础，主要任务是掌握被测信息系统的详细情况，准备测评工具，为编制密评方案做好准备。方案编制活动包括了解信息系统基本情况、确定评估范围、确定评估对象、编制评估方案等；现场测评活动包括现场测评准备、现场测评实施、现场测评总结等；分析与报告编制活动包括单元测评结果分析、整体测评分析、风险分析、测评结论确定、评估报告编制等。

### Q32: 密码应用安全性评估方案编制阶段的主要工作内容是什么？

<thinking>
方案编制阶段是评估工作的基础，需要从以下维度来理解：

1. 系统调研：
   - 了解信息系统的架构、业务流程
   - 识别系统的安全需求和风险点
   - 掌握现有的密码应用情况

2. 范围界定：
   - 明确评估的系统边界
   - 确定需要评估的组件和功能
   - 避免遗漏关键评估对象

3. 对象确定：
   - 物理安防设施、通信信道
   - 密码产品、通用设备
   - 应用系统、重要数据
   - 人员、制度文档等

4. 方案制定：
   - 评估目标和依据
   - 评估方法和步骤
   - 评估工具和人员安排
   - 时间计划和资源配置
</thinking>

A32: 密码应用安全性评估方案编制阶段的主要工作内容包括：了解信息系统基本情况（包括系统架构、业务流程、安全需求等）、确定评估范围（明确需要评估的系统边界和组件）、确定评估对象（确定物理安防设施、通信信道、密码产品、通用设备、应用、重要数据、人员、制度文档等测评对象）、编制评估方案（包括评估目标、评估依据、评估方法、评估步骤、评估工具、评估人员、评估时间安排等）。

### Q33: 密码应用安全性评估现场测评准备阶段的主要工作内容是什么？

<thinking>
现场测评准备阶段是确保测评顺利进行的关键环节：

1. 团队组建：
   - 选择具备相应资质的评估人员
   - 明确团队成员的职责分工
   - 确保团队具备必要的技术能力

2. 工具准备：
   - 准备评估所需的技术工具
   - 验证工具的可用性和准确性
   - 确保工具符合评估要求

3. 计划制定：
   - 制定详细的现场测评计划
   - 安排测评的时间和顺序
   - 预估测评所需的时间和资源

4. 协调沟通：
   - 与被评估单位建立有效沟通
   - 获取必要的系统访问权限
   - 收集相关的文档资料

5. 权限获取：
   - 确保能够访问需要测评的系统
   - 获取必要的管理员权限
   - 保证测评工作的顺利进行
</thinking>

A33: 密码应用安全性评估现场测评准备阶段的主要工作内容包括：组建评估团队、准备评估工具、制定现场测评计划、与被评估单位沟通协调、获取必要的系统访问权限和文档资料等。

### Q34: 密码应用安全性评估现场测评实施阶段的主要工作内容是什么？

<thinking>
现场测评实施阶段是评估工作的核心执行环节：

1. 测评执行：
   - 按照评估方案逐项进行测评
   - 对各个测评单元进行详细检查
   - 确保测评的全面性和准确性

2. 多种测评方式：
   - 访谈相关人员：了解管理制度执行情况
   - 审查相关文档：验证制度的完整性
   - 实地查验系统：检查技术实现情况
   - 进行技术测试：验证密码功能有效性

3. 证据收集：
   - 记录测评过程中的发现
   - 收集相关的证据材料
   - 确保证据的真实性和完整性

4. 问题识别：
   - 识别不符合要求的项目
   - 分析问题的严重程度
   - 为后续整改提供依据
</thinking>

A34: 密码应用安全性评估现场测评实施阶段的主要工作内容包括：按照评估方案对各个测评单元进行测评，包括访谈相关人员、审查相关文档、实地查验系统、进行技术测试等，记录测评过程中的发现和证据。

### Q35: 密码应用安全性评估现场测评总结阶段的主要工作内容是什么？

<thinking>
现场测评总结阶段是现场工作的收尾环节：

1. 记录整理：
   - 整理现场测评的所有记录
   - 分类归档收集的证据
   - 确保记录的完整性和准确性

2. 沟通确认：
   - 与被评估单位沟通初步发现
   - 确认测评结果的准确性
   - 澄清可能存在的误解

3. 总结报告：
   - 形成现场测评总结报告
   - 概述测评的主要发现
   - 为后续分析提供基础

4. 问题反馈：
   - 向被评估单位反馈主要问题
   - 提供初步的改进建议
   - 为整改工作做好准备
</thinking>

A35: 密码应用安全性评估现场测评总结阶段的主要工作内容包括：整理现场测评记录和证据、与被评估单位沟通确认初步发现、形成现场测评总结报告等。

### Q36: 密码应用安全性评估分析与报告编制阶段的主要工作内容是什么？

<thinking>
分析与报告编制阶段是评估工作的最终输出环节：

1. 单元测评结果分析：
   - 对每个测评单元的结果进行分析
   - 判定符合性程度
   - 识别存在的问题和风险

2. 整体测评分析：
   - 单元间测评：分析同一层面内不同单元的关联
   - 层面间测评：分析不同层面间的关联影响
   - 综合评估系统整体安全防护能力

3. 风险分析：
   - 分析不符合项可能带来的安全风险
   - 评估风险的可能性和影响程度
   - 确定风险等级和优先级

4. 测评结论确定：
   - 基于测评结果和风险分析
   - 确定最终的测评结论
   - 分为符合、基本符合、不符合三类

5. 评估报告编制：
   - 编制完整的评估报告
   - 包含测评过程、结果、结论
   - 提供改进建议和整改要求
</thinking>

A36: 密码应用安全性评估分析与报告编制阶段的主要工作内容包括：对各个测评单元的测评结果进行分析、进行整体测评分析（单元间测评和层面间测评）、进行风险分析、确定测评结论、编制评估报告等。

### Q37: 密码应用安全性评估报告的主要组成部分有哪些？

<thinking>
评估报告是评估工作的最终成果，需要包含完整的信息：

1. 报告摘要：
   - 简要概述评估的主要结论
   - 突出关键发现和建议
   - 便于管理层快速了解情况

2. 评估概述：
   - 评估背景：说明评估的必要性和目的
   - 评估目标：明确评估要达到的目标
   - 评估范围：界定评估的边界和对象
   - 评估依据：列出相关的法规标准

3. 评估方法：
   - 评估流程：描述评估的整体流程
   - 评估工具：说明使用的评估工具
   - 评估方法：阐述具体的评估方法

4. 评估结果：
   - 各测评单元的详细结果
   - 整体测评的综合结果
   - 风险分析的具体结果

5. 测评结论：
   - 基于评估结果得出的最终结论
   - 符合性判定和风险等级

6. 改进建议：
   - 针对发现问题的具体建议
   - 整改的优先级和时间要求

7. 附录：
   - 相关证据和详细记录
   - 支撑结论的技术数据
</thinking>

A37: 密码应用安全性评估报告的主要组成部分包括：报告摘要、评估概述（评估背景、评估目标、评估范围、评估依据等）、评估方法（评估流程、评估工具、评估方法等）、评估结果（各个测评单元的测评结果、整体测评结果、风险分析结果等）、测评结论、改进建议、附录（相关证据、记录等）。

### Q38: 密码应用安全性评估报告的评审流程是什么？

<thinking>
评估报告的评审流程确保报告质量和客观性：

1. 内部评审：
   - 评估团队内部的自我检查
   - 确保报告的完整性和准确性
   - 验证结论的合理性

2. 专家评审：
   - 邀请相关领域的专家
   - 对报告进行专业性评审
   - 提供技术意见和建议

3. 客户评审：
   - 提交给被评估单位评审
   - 听取客户的意见和反馈
   - 确保报告的可接受性

4. 修改完善：
   - 根据各方评审意见
   - 对报告进行修改和完善
   - 确保报告的质量和准确性

5. 正式发布：
   - 形成最终的正式报告
   - 按照规定程序发布
   - 作为正式的评估结果
</thinking>

A38: 密码应用安全性评估报告的评审流程通常包括：内部评审（评估团队内部对报告进行审核）、专家评审（邀请相关领域专家对报告进行评审）、客户评审（提交给被评估单位进行评审），根据评审意见修改完善报告，最终形成正式评估报告。

### Q39: 密码应用安全性评估的周期性要求是什么？

<thinking>
周期性评估是确保密码应用持续安全的重要机制：

1. 等级差异化要求：
   - 不同等级系统有不同的评估频率
   - 高等级系统需要更频繁的评估
   - 体现风险管控的差异化原则

2. 第三级和第四级要求：
   - 在运行过程中定期开展评估
   - 包括密码应用安全性评估
   - 还要进行攻防对抗演习

3. 评估周期考虑因素：
   - 系统的重要性程度
   - 系统的变化情况
   - 威胁环境的变化
   - 法规标准的更新

4. 建议频率：
   - 通常建议每年至少一次
   - 重要系统可能需要更频繁
   - 发生重大变更时应及时评估

5. 整改闭环：
   - 评估后要根据结果进行整改
   - 形成持续改进的闭环机制
   - 不断提升安全防护水平
</thinking>

A39: 密码应用安全性评估的周期性要求因系统等级不同而异：第三级和第四级信息系统要求在运行过程中，应定期开展密码应用安全性评估及攻防对抗演习，并根据评估结果进行整改。具体周期可根据系统重要性、变化情况等因素确定，每年至少进行一次评估。

## 密码应用方案设计类

### Q40: 密码应用方案设计的主要依据有哪些？

<thinking>
密码应用方案设计需要有充分的依据来确保合规性和有效性：

1. 法律法规依据：
   - 《中华人民共和国密码法》：基础法律框架
   - 《网络安全法》：网络安全基本要求
   - 《数据安全法》：数据保护要求
   - 其他相关法律法规

2. 标准规范依据：
   - 国家标准：如GB/T 39786-2021等
   - 行业标准：各行业的具体要求
   - 国际标准：参考国际最佳实践

3. 系统特性依据：
   - 信息系统安全需求：基于业务需要
   - 系统业务特点：不同业务有不同要求
   - 系统架构：技术架构决定实现方式

4. 现状分析依据：
   - 现有安全措施：已有的安全基础
   - 存在的安全风险：需要重点防护的方面
   - 技术发展趋势：考虑未来发展需要
</thinking>

A40: 密码应用方案设计的主要依据包括：信息系统安全需求、相关法律法规（如《中华人民共和国密码法》）、国家标准（如GB/T 39786-2021）、行业标准、系统业务特点、系统架构、现有安全措施等。

### Q41: 密码应用方案设计的主要原则有哪些？

<thinking>
密码应用方案设计需要遵循一系列重要原则：

1. 总体性原则：
   - 依据GB/T 39786基本要求，结合系统安全需求
   - 融入责任单位密码应用规划，开展顶层设计

2. 科学性原则：
   - 参考系统密码、管理需求与整体规划
   - 合理整合部署密码资源，解决实际安全问题

3. 完备性原则：
   - 覆盖法律、法规、标准对密码使用的要求
   - 设计满足信息系统全场景安全需求的方案

4. 可行性原则：
   - 方案贴合实际，便于系统建设、验收落地
   - 可作为密码应用安全性评估的依据

5. 合规性原则：
   - 密码算法、技术遵循国家相关标准
   - 密码产品和服务经认证机构认证合格 
</thinking>

A41: 密码应用方案设计的主要原则如下：
1） 总体性原则：按照 GB/T 39786 对信息系统密码应用的基本要求，以及信息系统的安全需求、责任单位的密码应用规划和密码管理需求，进行顶层设计。
2） 科学性原则：参考信息系统的密码需求、管理需求和整体规划，合理整合和部署密码资源，切实解决应用中的安全问题。
3） 完备性原则：依据法律、法规、标准等关于密码使用的要求，设计满足信息系统安全需求的密码应用方案。
4） 可行性原则：密码应用方案切合实际、便于实现，能作为信息系统密码应用建设、验收和密码应用安全性评估的依据。
5） 合规性原则：密码应用方案中使用的密码算法遵循国家有关法律法规的要求；使用的密码技术遵循国家及行业相关标准；涉及国家安全、国计民生、社会公共利益的信息系统，其使用的密码产品和服务经商用密码认证机构认证合格。

### Q42: 密码应用方案设计的过程有哪些？

<thinking>
密码应用方案设计是一个系统性的过程：

1. 密码应用需求分析：
   - 分析系统的现状，确定安全需求
   - 明确密码应用技术要求和管理要求
   - 不采用密码技术的，进行风险评估和论证

2. 密码应用设计分析：
   - 参考标准要求，进行密码应用设计
   - 提出密码应用管理要求

3. 安全与合规分析：
   - 对照标准要求，对方案的适用性进行检查
   - 对适用项，进行分析和自评
</thinking>

A42: 围绕具体开展的业务应用，设计使用密码技术来满足信息系统安全需求的密码应用方案。密码应用设计过程包括三项基本流程：密码应用需求分析、密码应用设计分析、安全与合规性分析。
1.密码应用需求分析
分析信息系统现状，明确需要保护的信息资源和所涉及的范围，确定信息系统的安全需求。依据 GB/T 22240 中等级保护定级，按照 GB/T 39786 中对不同等级的信息系统提出的密码应用基本要求，针对信息系统建设的安全策略和业务安全需求，明确密码应用技术要求和管理要求。对使用其他替代性风险控制措施而不采用密码技术的，做出相应的说明并在密码应用方案设计时进行风险评估和论证。
2.密码应用设计分析
参照 GB/T 22240 中等级保护定级，根据被保护对象的密码需求和在 GB/T 39786 中所处的层面以及对应等级下 GB/T 39786 对该对象的密码应用基本要求，进行密码应用设计，包括计算平台密码应用方案设计、密码支撑平台方案设计和业务应用的密码应用方案设计，并从信息系统的管理制度、人员管理、建设运行和应急处置四个方面提出密码应用管理要求。
3.安全与合规性分析
逐条对照 GB/T 39786 对应等级下的各项密码应用技术要求，对方案的适用性进行检查。
a）有下列情况时，对应的指标项可为 “不适用”，对于不适用的项，做出相应的说明：
1）GB/T 39786 中有 “应”“宜” 的指标项而实际信息系统中不存在对应对象，指标项可为 “不适用”；
2）GB/T 39786 中有 “宜” 的指标项，信息系统采用替代性风险控制措施满足风险控制需求，指标项可为 “不适用”；
3）GB/T 39786 中有 “可” 的指标项，信息系统责任方自行决定是否采用密码技术保护指标涉及的保护对象，若决定不采用密码技术保护指标涉及的保护对象，指标项可为 “不适用”。
b）对于适用的项，逐条对照 GB/T 39786 对应等级下的各项密码应用技术要求，对方案的安全控制措施进行分析与自评，若指标涉及的所有保护对象的相应安全控制措施（密码保障措施、缓解及替代性措施）有效、不存在高风险，且方案中描述的实施保障措施合理，则该指标的自评结果为通过；否则，该指标的自评结果为未通过。


### Q43: 密码应用管理方案设计的主要内容有哪些？

<thinking>
密码应用管理方案是确保密码应用有效运行的重要保障：

1. 管理制度设计：
   - 密码应用安全管理制度：总体管理框架
   - 操作规程：具体操作的标准化流程
   - 制度体系的完整性和一致性

2. 人员管理设计：
   - 密码应用岗位责任制度：明确各岗位职责
   - 人员培训制度：确保人员具备必要技能
   - 人员考核制度：定期评估人员能力
   - 保密制度：确保关键信息不泄露

3. 建设运行管理设计：
   - 密码应用方案实施流程：规范建设过程
   - 运行维护流程：确保系统稳定运行
   - 变更管理流程：规范系统变更过程
   - 评估流程：定期评估密码应用效果

4. 应急处置管理设计：
   - 密码应用应急策略：应对突发事件
   - 事件处置流程：快速响应和处理
   - 恢复流程：尽快恢复正常运行
   - 总结改进：从事件中吸取经验教训
</thinking>

A43: 密码应用管理方案设计的主要内容包括：管理制度设计（如密码应用安全管理制度、操作规程等）、人员管理设计（如密码应用岗位责任制度、人员培训制度等）、建设运行管理设计（如密码应用方案实施流程、运行维护流程等）、应急处置管理设计（如密码应用应急策略、事件处置流程等）。


## 密钥管理具体操作类

### Q44: 密钥生成过程中的安全控制措施有哪些？

<thinking>
密钥生成是密钥生命周期的起点，安全控制至关重要：

1. 生成环境安全控制：
   - 在符合GB/T37092的密码产品中生成
   - 确保生成环境的物理安全
   - 限制对生成环境的访问权限

2. 随机数生成器安全控制：
   - 使用经过验证的随机数生成器
   - 确保随机数的质量和不可预测性
   - 定期检测随机数生成器的状态

3. 访问权限控制：
   - 限制密钥生成过程的访问权限
   - 实施多人控制机制
   - 确保只有授权人员能够生成密钥

4. 信息记录控制：
   - 记录密钥生成的相关信息
   - 包括密钥种类、长度、拥有者等
   - 记录使用起始时间和终止时间

5. 审计控制：
   - 对密钥生成过程进行审计
   - 记录生成操作的详细信息
   - 确保审计记录的完整性和安全性

6. 质量控制：
   - 验证生成密钥的质量
   - 确保密钥符合安全要求
   - 检测密钥的随机性和唯一性
</thinking>

A44: 密钥生成过程中的安全控制措施包括：在符合GB/T37092的密码产品中生成密钥、使用经过验证的随机数生成器、确保生成环境的物理安全、限制生成过程的访问权限、记录密钥生成相关信息（如密钥种类、长度、拥有者、使用起始时间、使用终止时间等）、对生成过程进行审计等。

### Q45: 密钥分发过程中的安全控制措施有哪些？

<thinking>
密钥分发是将密钥从一个地方安全传递到另一个地方的过程：

1. 分发通道安全控制：
   - 使用安全的分发通道
   - 如加密通道、物理安全传输等
   - 确保传输过程的安全性

2. 身份验证控制：
   - 验证分发者的身份
   - 验证接收者的身份
   - 确保密钥分发给正确的对象

3. 机密性和完整性保护：
   - 确保密钥在分发过程中的机密性
   - 确保密钥在分发过程中的完整性
   - 防止密钥被窃取或篡改

4. 分发信息记录：
   - 记录密钥分发的相关信息
   - 包括分发时间、分发对象等
   - 为后续审计提供依据

5. 审计控制：
   - 对密钥分发过程进行审计
   - 记录分发操作的详细信息
   - 确保分发过程的可追溯性

6. 应急处理机制：
   - 建立密钥分发失败的应急处理机制
   - 制定分发异常的处理流程
   - 确保能够及时处理分发问题
</thinking>

A45: 密钥分发过程中的安全控制措施包括：使用安全的分发通道（如加密通道、物理安全传输等）、验证分发者和接收者的身份、确保密钥在分发过程中的机密性和完整性、记录密钥分发相关信息（如分发时间、分发对象等）、对分发过程进行审计、建立密钥分发失败的应急处理机制等。

### Q46: 密钥存储过程中的安全控制措施有哪些？

<thinking>
密钥存储是保护密钥安全的重要环节：

1. 存储方式控制：
   - 不在密码产品外部以明文方式存储密钥
   - 公钥除外，可以明文存储
   - 使用加密方式保护存储的密钥

2. 存储介质安全控制：
   - 使用安全的存储介质
   - 对存储介质进行物理保护
   - 防止存储介质被盗取或损坏

3. 访问控制：
   - 实施严格的访问控制
   - 限制对密钥的访问权限
   - 确保只有授权人员能够访问

4. 加密保护：
   - 对存储的密钥进行加密保护
   - 使用强加密算法
   - 定期更换加密密钥

5. 备份控制：
   - 定期备份重要密钥
   - 确保备份的安全性
   - 建立备份恢复机制

6. 存储信息记录：
   - 记录密钥存储的相关信息
   - 包括存储位置、存储时间等
   - 为管理和审计提供依据

7. 审计控制：
   - 对密钥存储过程进行审计
   - 记录存储操作的详细信息
   - 定期检查存储安全状况
</thinking>

A46: 密钥存储过程中的安全控制措施包括：不在密码产品外部以明文方式存储密钥（公钥除外）、使用安全的存储介质、对存储介质进行物理保护、实施访问控制（限制对密钥的访问权限）、对密钥进行加密保护、定期备份密钥、记录密钥存储相关信息、对存储过程进行审计等。

### Q47: 密钥使用过程中的安全控制措施有哪些？

<thinking>
密钥使用是密钥发挥作用的关键环节：

1. 使用授权控制：
   - 确保密钥使用的授权
   - 验证使用者的身份和权限
   - 防止未授权使用密钥

2. 有效性验证：
   - 验证密钥的有效性
   - 检查密钥的有效期
   - 确认密钥的使用范围

3. 单一用途原则：
   - 限制密钥的使用范围
   - 遵循单一用途原则
   - 防止密钥被滥用

4. 泄露防护：
   - 防止密钥在使用过程中被泄露
   - 防止密钥被非法替换
   - 采取必要的安全防护措施

5. 使用信息记录：
   - 记录密钥使用的相关信息
   - 包括使用时间、使用者、使用目的等
   - 为审计和管理提供依据

6. 审计控制：
   - 对密钥使用过程进行审计
   - 记录使用操作的详细信息
   - 及时发现异常使用行为

7. 异常检测和处理：
   - 建立密钥使用异常的检测机制
   - 制定异常处理流程
   - 及时响应和处理异常情况
</thinking>

A47: 密钥使用过程中的安全控制措施包括：确保密钥使用的授权、验证密钥的有效性（如有效期、使用范围等）、限制密钥的使用范围（单一用途原则）、防止密钥在使用过程中被泄露或替换、记录密钥使用相关信息、对使用过程进行审计、建立密钥使用异常的检测和处理机制等。

### Q48: 密钥更新过程中的安全控制措施有哪些？

<thinking>
密钥更新是维护密钥安全性的重要机制：

1. 更新策略控制：
   - 制定明确的密钥更新策略
   - 确定更新周期和触发条件
   - 如定期更新、泄露时更新等

2. 新密钥生成安全控制：
   - 确保新密钥生成的安全性
   - 使用安全的生成方法
   - 验证新密钥的质量

3. 新密钥分发安全控制：
   - 安全地分发新密钥
   - 确保分发过程的机密性和完整性
   - 验证接收者的身份

4. 旧密钥停用控制：
   - 安全地停用旧密钥
   - 确保旧密钥不再被使用
   - 处理旧密钥的归档或销毁

5. 业务连续性保障：
   - 确保新旧密钥过渡期的业务连续性
   - 制定平滑切换方案
   - 最小化对业务的影响

6. 更新信息记录：
   - 记录密钥更新的相关信息
   - 包括更新时间、更新原因等
   - 为管理和审计提供依据

7. 审计控制：
   - 对密钥更新过程进行审计
   - 记录更新操作的详细信息
   - 确保更新过程的可追溯性
</thinking>

A48: 密钥更新过程中的安全控制措施包括：制定明确的密钥更新策略（如更新周期、更新触发条件等）、确保新密钥生成的安全性、安全地分发新密钥、安全地停用旧密钥、确保新旧密钥过渡期的业务连续性、记录密钥更新相关信息、对更新过程进行审计等。